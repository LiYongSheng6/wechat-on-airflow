# wechat-on-airflow

## 项目简介

wechat-on-airflow 是一个基于 Apache Airflow 的项目，用于管理和编排 AI 驱动的微信聊天机器人工作流，实现自动回复消息、定时发送通知、自动更新菜单以及与微信 API 集成等自动化任务，提升微信机器人的响应效率和运营优化。

## 整体架构

```
+----------------------------------------------------------------------------------------+
|                      🌐 WEB UI  （前端： 多账号管理、智能客服管理等）                        |          
+----------------------------------------------------------------------------------------+
      |                                        |                             |
查询聊天记录(触发式）             发送消息\查询状态数据(触发式+定时任务）        知识库接口(触发式)       
      ↓                                        ↓                             ↓   
+---------+       +---------+       +------------------------+       +-------------------+       +-------------+
| ☁️ 云函数 | <---> | 💾 Mysql | <--->| ⭐️ Airflow （开源项目）   | --- > | 🤖 Dify （开源项目）| --- > | 🧠 大模型服务 |
+---------+       +---------+       +------------------------+       +-------------------+       +-------------+
                                          ↑                |
                                    +------------------+   |
                                    | 🔌 Webhook (自研) |  WCF API
                                    +------------------+   |
                                          ↑                |
                                    上报新消息(触发式)    发送消息\查询数据(触发式+定时任务）
                                          |                ↓
                                    +----------------------------+
                                    | 🔄 WCF (开源项目, Windows)   |
                                    +----------------------------+
                                          ↑                ↓
                                          |                |
                                         Hook             Hook
                                          |                |
                                    +---------------------------+
                                    | 💬 微信客户端 （Windows）    |
                                    +---------------------------+

备注：
- 微信客户端： 使用 wcf-client-rust 项目， 基于 wcf 协议， 实现微信客户端功能
- Webhook： 自研， 基于 HTTP API 实现
- Airflow： 开源项目， 用于管理和编排工作流
- Dify： 开源项目， 用于智能客服管理
- 大模型服务： 基于大模型 API 实现
```

## Airflow流程功能列表

- [x] 接受微信新消息, 并分发到不同的Dify应用
- [x] 定时更新微信账号状态\联系人数据
- [x] 发送微信消息
- [ ] 缓存聊天记录到Mysql
- [ ] 缓存联系人数据到Mysql
- [ ] 发送图片
- [ ] 发送视频
- [ ] 发送语音
- [ ] 发送文件


## 微信功能列表

- [x] 发送文字消息
- [x] 发送图片消息
- [x] 接收视频消息
- [ ] 支持发送文件
- [ ] 支持发送视频
- [ ] 支持发送语音
- [ ] 支持发送文件


## 关联项目

- [前端UI](https://github.com/YuChanGongzhu/ai-agent)
- [airflow](https://github.com/apache/airflow)
- [wcf-client-rust](https://github.com/lich0821/wcf-client-rust)
- [dify](https://github.com/langgenius/dify)

## 开发人员

<a href="https://github.com/claude89757/wechat-on-airflow/graphs/contributors">![](https://contrib.rocks/image?repo=claude89757/wechat-on-airflow)</a>
